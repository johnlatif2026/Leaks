<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>داشبورد الادمن</title>
<style>
body { font-family: Arial; text-align:center; margin-top:30px; }
img { max-width:150px; margin-top:10px; }
</style>
</head>
<body>
<h2>داشبورد الادمن</h2>

<form id="adminForm">
  <input type="text" name="name" placeholder="الاسم"><br>
  <textarea name="description" placeholder="الوصف"></textarea><br>
  <input type="file" name="image" accept=".jpg"><br>
  <button type="submit">رفع / تعديل البيانات</button>
</form>

<div id="status" style="margin-top:20px;"></div>

<script>
const token = localStorage.getItem('token');
if(!token) window.location.href='/login';

async function fetchData() {
  const res = await fetch('/api/data');
  const data = await res.json();
  if(data.name) {
    document.getElementById('status').innerHTML = `
      <h3>البيانات الحالية:</h3>
      <p>الاسم: ${data.name}</p>
      <p>الوصف: ${data.description}</p>
      ${data.imageUrl ? `<img src="${data.imageUrl}"/>` : ''}
      <p>اخر تحديث: ${data.updatedAt}</p>
    `;
  }
}
fetchData();

document.getElementById('adminForm').onsubmit = async (e) => {
  e.preventDefault();
  const form = e.target;
  const formData = new FormData(form);

  const res = await fetch('/api/data', {
    method: 'POST',
    headers: { 'Authorization': token },
    body: formData
  });
  if(res.ok) {
    alert('تم رفع البيانات');
    fetchData();
  } else alert('حصل خطأ');
}
</script>
</body>
</html>
